<config xmlns="http://tail-f.com/ns/config/1.0">
  <devices xmlns="http://tail-f.com/ns/ncs">
  <device>
    <name>{$IR}</name>
      <config>
      <configuration xmlns="http://xml.juniper.net/xnm/1.1/xnm">
      <routing-instances>
      <instance>
        <name>{$VLAN}</name>
        <instance-type>vpls</instance-type>
        <vlan-id>{$VLAN}</vlan-id>
        <routing-interface>irb.{$VLAN}</routing-interface>
        <route-distinguisher>
          <rd-type>{$LOOPBACK_IR}:{$VLAN}</rd-type>
        </route-distinguisher>
        <vrf-target>
          <community>target:65512:{$VLAN}</community>
        </vrf-target>
        <protocols>
          <vpls>
            <no-tunnel-services/>
            <site>
              <name>{$IR}</name>
              <site-identifier>{$IRSI}</site-identifier>
            </site>
            <connectivity-type>irb</connectivity-type>
          </vpls>
        </protocols>
      </instance>
      </routing-instances>
      <interfaces>
      <interface>
        <name>irb</name>
        <unit>
          <name>{$VLAN}</name>
          <family>
            <inet>
              <address>
                <name>{$LIP}/30</name>
              </address>
            </inet>
          </family>
        </unit>
      </interface>
      </interfaces>
       <protocols>
          <bgp>
            <group>
              <name>eBGP-{$AS}</name>
              <type>external</type>
              <local-address>{$LIP}</local-address>
              <family>
                <inet>
                  <unicast>
                  </unicast>
                </inet>
              </family>
              <peer-as>{$AS}</peer-as>
              <neighbor>
                <name>{$PIP}</name>
              </neighbor>
            </group>
          </bgp>
        </protocols>
      </configuration>
      </config>
  </device>
  </devices>
</config>
